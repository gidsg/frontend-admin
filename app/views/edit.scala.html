@(config: String)

@main("Front editor", isAuthed = true) {
    <script>
        var frontConfig = @Html(config)
    </script>

    <form id="network-front">
        <!--
        <fieldset class="trailblocks">
            <legend>UK Edition</legend>
            <label for="tag">Tag</label>
            <input type="text" class="typeahead" data-provide="typeahead" data-items="4" data-source='["abc", "asd", "asdf"]' name="tag" />
            <input type="hidden" name="edition" value="uk" />
        <fieldset> -->
        <fieldset class="trailblocks">
            <legend>US Edition</legend>
            <label for="tag">Tag</label>
            <input type="text" class="typeahead" name="tag" autocomplete="off" />
            <input type="hidden" name="edition" value="us" />
        </fieldset>
        <div id="autocomplete"></div>
        <input type="submit" value="Save" />
    </form>

    <script>
    /*

        Auto-complete with mediator pattern
        
        - tagentry : Manages keyboard input & broadcasts a message when it's been received.
                    It also listens for autocomplete events to populate itself.   
        - autocomplete: Listens for tagentry messages and queries the auto-complete API
                    and presents a list of valid options from the returned resultss

    */
    
        curl([
                'controllers/trailblocks',
                'Config',
                'Common',
                'TagEntry',
                'AutoComplete',
                'TagSearch',
                'ItemSearch']).then(
            function(
                Trailblocks,
                Config,
                Common,
                TagEntry,
                AutoComplete,
                TagSearch,
                ItemSearch) {
            
            new Trailblocks({el: $("body")})
            new TagSearch.init( { apiEndPoint: 'http://content.guardianapis.com/tags', config: Config } );
            new TagEntry.init( { nodeList: $('.typeahead') } );
        });

    </script>

}
